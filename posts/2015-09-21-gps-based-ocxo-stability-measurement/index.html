<!doctype html>
<html ⚡ lang="ja-jp">
  <head>
    <meta charset="utf-8" />
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script>

    
    <title>GPSのPPS信号を基準にOCXOの安定度を観察してみる</title>

    
    




  
  <meta name="author" content="TT" />
  <meta name="description" content="" />

  
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@edy555" />
  <meta name="twitter:title" content="Computer &amp; RF Technology" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:image" content="https://ttrf.tk/img/avatar.jpg" />




<meta name="generator" content="Hugo 0.54.0">


<link rel="canonical" href="https://ttrf.tk/posts/2015-09-21-gps-based-ocxo-stability-measurement/">
<link rel="alternative" href="/index.xml" title="Computer &amp; RF Technology" type="application/atom+xml">


<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="format-detection" content="telephone=no,email=no,adress=no" />


<meta name="robots" content="index,follow" />
<meta name="referrer" content="origin-when-cross-origin" />




<link rel="icon" href="/img/favicon.ico" />
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="apple-touch-icon" sizes="120x120" href="/img/avatar.jpg">



<link rel="stylesheet" href="/css/nostalgia.css">





  <link rel="stylesheet" href="/css/fork-awesome.min.css">


  </head>
  <body>
    
    <div id="contain">
	  

<div id="sidebar" class="sidebar">
  <section class="first odd">

    
      <h1><a href="https://ttrf.tk">Computer &amp; RF Technology</a></h1>
    

	  <h4>About</h4>
      
        SDRや測定器などソフトウェア寄りのRF実験についてのメモです。キット頒布中。
      
  </section>



  <section class="odd">
  
      <a target="_blank" href="https://github.com/ttrftech" title="ttrftech"><i class="fa fa-github fa-2x"></i></a>
      
      
      <a target="_blank" href="https://twitter.com/edy555" title="edy555"><i class="fa fa-twitter fa-2x"></i></a>
      
         
      
      
      
      
      
      
      
      

    
      <a href="https://ttrf.tk/index.xml" type="application/rss+xml" title="RSS"><i class="fa fa-rss-square fa-2x"></i></a>
        <ul class="sidebar-nav"></ul>
    </section>
  

  
    
      <section id="menu" class="odd">
        
          <h4>Special Pages</h4>
        
        <ul class="sidebar-nav">
        
          <li class="sidebar-nav-item">
            <a href="https://ttrf.tk/kit/adsbamp" title="ADS-Bプリアンプキット" >ADS-Bプリアンプキット</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="https://ttrf.tk/kit/centsdr" title="CentSDRキット" >CentSDRキット</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="https://ttrf.tk/kit/hfconv/" title="HFCONVキット" >HFCONVキット</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="https://ttrf.tk/kit/lpclink2bb/" title="LPC-Link2ブレイクアウトボード" >LPC-Link2ブレイクアウトボード</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="https://ttrf.tk/kit/nanovna/" title="NanoVNAキット" >NanoVNAキット</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="https://ttrf.tk/tags/" title="Tags" >Tags</a>
          </li>
        
        </ul>
      </section>
    
  

  
    
      <section id="menu" class="odd">
        
          <h4>Links</h4>
        
        <ul class="sidebar-nav">
        
          <li class="sidebar-nav-item">
            <a href="https://www.amazon.co.jp/gp/product/B00M6LTKNE/ref=as_li_ss_tl?ie=UTF8&amp;camp=247&amp;creative=7399&amp;creativeASIN=B00M6LTKNE&amp;linkCode=as2&amp;tag=fromsapporo07-22" title="HFコンバータ完成品" >HFコンバータ完成品</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="https://astore.amazon.co.jp/ttrftech-22" title="関連アイテム一覧" >関連アイテム一覧</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="https://www.amazon.co.jp/gp/product/B00F9COA64/ref=as_li_ss_tl?ie=UTF8&amp;camp=247&amp;creative=7399&amp;creativeASIN=B00F9COA64&amp;linkCode=as2&amp;tag=ttrftech-22" title="記事掲載:トラ技 2013年11月号" >記事掲載:トラ技 2013年11月号</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="https://www.amazon.co.jp/gp/product/B008CMZLQG/ref=as_li_ss_tl?ie=UTF8&amp;camp=247&amp;creative=7399&amp;creativeASIN=B008CMZLQG&amp;linkCode=as2&amp;tag=ttrftech-22" title="記事掲載:トラ技 2014年6月号" >記事掲載:トラ技 2014年6月号</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="https://www.amazon.co.jp/gp/product/B00VS238YY/ref=as_li_ss_tl?ie=UTF8&amp;camp=247&amp;creative=7399&amp;creativeASIN=B00VS238YY&amp;linkCode=as2&amp;tag=ttrftech-22" title="特集執筆:Interface 2015年7月号" >特集執筆:Interface 2015年7月号</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="https://www.amazon.co.jp/gp/product/B010TMHK06/ref=as_li_ss_tl?ie=UTF8&amp;camp=247&amp;creative=7399&amp;creativeASIN=B010TMHK06&amp;linkCode=as2&amp;tag=fromsapporo07-22" title="連載記事:Interface 2015年10月号〜2016年8月号" >連載記事:Interface 2015年10月号〜2016年8月号</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="https://www.amazon.co.jp/gp/product/B06XN73MWK/ref=as_li_ss_tl?ie=UTF8&amp;camp=247&amp;creative=7399&amp;creativeASIN=B06XN73MWK&amp;linkCode=as2&amp;tag=ttrftech-22" title="特集分担:Interface 2017年6月号" >特集分担:Interface 2017年6月号</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="https://amzn.to/2Ss0YWr" title="特集分担:Interface 2018年9月号" >特集分担:Interface 2018年9月号</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="https://amzn.to/2RiOqyS" title="特集執筆:RFワールドNo.44" >特集執筆:RFワールドNo.44</a>
          </li>
        
        </ul>
      </section>
    
  
	  

  
  
    
      <section class="even">
        <h4>Recent Posts</h4>
        <ul id="recent_posts"  class="sidebar-nav">
          
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2018-10-28-gnuradio-grc-rfworld-no44/">GNU Radioの入門に是非！解説記事をRFワールドNo44特集「GRCで広がるSDRの世界」に寄稿しました</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2018-07-27-centsdr-lcd-panel/">CentSDRに使えるLCDパネルのバリエーション</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2018-07-01-centsdr-kit-2nd-lot/">CentSDR 2nd lotをキット頒布します</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2018-04-23-gnuradio-osx-with-homebrew/">GNURadioをOSX&#43;Homebrewで整備してみました</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2018-02-11-centsdr-powermeter-frequency-response-and-linerinity/">CentSDRのパワーメータの周波数特性と直線性を測定してみた</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2018-02-04-centsdr-fm-broadcasting-reception/">CentSDRでFMラジオが受信できるようになりました</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2018-01-20-rfworld-workshop-meeting-2018/">RFワールド Workshop&amp;Meeting 2018で話します</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2018-01-17-centsdr-rf-power-meter/">CentSDRにパワーメータを付けてみました</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2018-01-11-centsdr-parts-kit/">CentSDRのキットを頒布します</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2017-11-19-makerfaireshenzhen2017/">深圳のMakerFaire Shenzhen 2017に行ってきました</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2017-11-04-centsdr-spectrum-and-waveform-display/">CentSDRでスペクトラムに加えて波形も表示するようにしてみた</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2017-10-09-dcoffset-rejection-from-adc-and-cmsis-dsp-library/">CentSDRの信号処理におけるDCオフセット補償</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2017-09-18-plotting-airrace-tracklog-with-rtl-sdr/">RTL-SDRでエアレース機のADS-Bメッセージを受信し、飛行軌跡をJupyterとpandasでGeoJSONに変換してプロットしてみる</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2017-08-15-centsdr-stm32-based-standalone-receiver/">CentSDRを組み立ててみました</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2017-08-04-centsdr-mcu-based-standalone-sdr-receiver/">ワンボードSDR CentSDRを試作中です</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2017-02-25-hmc472-digital-step-attenuator-and-nanosg/">HMC472ステップアッテネータチップを試してみる</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2017-02-19-limesdr-in-the-aluminium-box/">LimeSDRをケースにいれてみました</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2017-02-09-limesdr-unboxing-and-using-with-gqrx/">LimeSDRをGQRXで使ってみる</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2017-02-05-as5600-magnet-rotary-hall-sensor/">ロータリホールセンサAS5600を試用してみる</a>
              </li>
            
          
            
              <li class="post sidebar-nav-item">
                <a href="/posts/2017-01-15-measure-crystal-filter-with-nanovna/">NanoVNAでクリスタルフィルタの特性を見てみる</a>
              </li>
            
          
        </ul>
      </section>
    
  

  
<a class="twitter-timeline" data-height="800" href="https://twitter.com/edy555?ref_src=twsrc%5Etfw">Tweets by edy555</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  
</div>

	  
<div id="contain">
  <div id="content">
    <div class="regular">
      <article class="hentry" role="article">
		<time class="date">Monday, Sep 21, 2015</time>
<h2><a href="https://ttrf.tk/posts/2015-09-21-gps-based-ocxo-stability-measurement/" class="title">GPSのPPS信号を基準にOCXOの安定度を観察してみる</a></h2>


        

        <div class="entry-content">
          
          
          
          <p>以前さわりだけご紹介したGPS基板ですが、GPSを周波数源として活用したいというのがそもそもの目的でした。GPSモジュールはPPS信号＝1秒毎のパルスだけではなく設定で任意の周波数を出力可能なのですが、実はその信号は周波数源としては安定度／信号純度が後に述べる理由から全く不十分なのです。</p>

<p>そこで、GPSを基準に使って、安定で純度の高い信号が得られるOCXOを制御するGPSDOを作ろうとしています。が、その前段階としてGPSのPPS信号を基準にしてOCXOをカウントしてみました。実はこの実験はすでに一年前にやっていてその後放置していたのですが、ようやく再開することにしました。</p>

<p><img src="https://36.media.tumblr.com/21acd5af972b340253dec44094535871/tumblr_inline_nuzhzdqiRl1r9hszk_540.jpg" alt="image" /></p>

<p>GPSは手軽に得られる時刻源です。GPSはその原理上、正確な時刻と周期が得られます。GPSの電波が受信できる環境であれば、GPSモジュールからはPPS信号(Pulse Per Second)として正確な1秒毎のパルスが得られます。</p>

<p>一方、安定な発振器としてOCXO (Oven Controlled Xtal Oscillator)があります。比較的大型の部品で、ケース内にヒーターが組み込まれていて、内部の発振器が最適な温度で動作できるよう精密に温度制御されています。ヒータのため比較的消費電流が大きく、また温度が安定するまで一定の時間を要します。さらに精密な制御をするために、オーブンが2重になったDOCXO(Double Oven Controlled XO)というものも使われています。</p>

<p>さて、周波数源＝時刻源としては正確さと安定性の両方が求められます。正確さとは絶対値の誤差が少ないこと。安定性とは周波数が揺れ動かないことです。OCXOは周波数の揺れはとても少ないのですが、周波数の絶対値の正確さは十分ではありません。ただし、揺れが少ないとは言っても、長い期間でみるとわずかにドリフトがあります。一方、GPSから得られる時刻は、衛星の観測状況の変化などにより短期的にはわずかに揺れ動くのですが、長期的には原子時計レベルの安定性を持っていると言われています。</p>

<p>さらにGPSモジュールから得られる信号の純度には限界があります。それはGPSモジュールそのものが内部に持つクロックに起因しています。GPSモジュールの出力はそのクロックに同期していて、そのクロック以上の時間精度は出ないからです。ubloxのモジュールの場合、その内部は48MHzのクロックで動作していて、出力されるPPS信号のクロックエッジは、本来のUTCの秒のエッジからは20nsのオーダーで差異が生じています。このためPPS信号にはわずかなジッターが生じており、周波数源としてみると少なくない位相雑音があるのです。(実はGPSモジュールからは(一部の品種に限って)、これを補正するための情報が出力されています。PPS信号が本来のUTC秒からどの程度ずれがあるかが、NMEA形式で出力されるデータから毎秒取得することができます。)</p>

<p>やりたいことは、短期的には安定だけれども、長期的にはイマイチな水晶発振器=OCXOを、短期的にはダメだけど、長期的には安定で正確な時刻源であるGPSを使って調律(Discipline)することです。互いにいいとこ取りをして、短期的にも長期的にも安定な発振器にしようということです。このような発振器をGPSDO(GPS Disciplined Oscillator)といいます。(Z3801などが有名ですね)</p>

<p>そのための実験として、GPSのPPS信号を使って、OCXOの10MHzをカウントしてみて、どのくらいの安定度があるのか観察してみました。</p>

<p>使ったGPSモジュールはubloxのLEA-6Tです。Tという型番はTime Precisionタイプのモジュールであることを示しています。通常のモジュールに比べて、時刻に関する機能が追加されています。</p>

<p>実験用に作ったGPS基板には、MCUとしてPIC18F14K50を載せています。PICのUSBインターフェースを使ってCDCデバイスを構成し、データをPCに取り込めるようにします。またI2C LCDを載せてGPSの動作状況を表示するようにします。OCXOからの信号をペリフェラルを使ってカウントし、PPS信号をトリガーにカウント値をサンプリングします。これらをPICのファームウェアで実装します。</p>

<p><img src="https://36.media.tumblr.com/74955cb53ba75e5e7234e5f71f07eb50/tumblr_inline_nuzpvaUrgA1r9hszk_540.jpg" alt="image" /></p>

<p>いろいろミスがありますが、回路図です。<a href="https://dl.dropboxusercontent.com/u/223520/gpsdo-experiment1.png" target="_blank">リンク</a></p>

<p><img src="https://41.media.tumblr.com/fd1b164beba7aac9a138f4da6af6516e/tumblr_inline_nuztl3GtvY1r9hszk_540.png" alt="image" /></p>

<p>この基板にはGPSモジュール並びにPIC、二つのUSBコネクタがあります。どちらもCDCデバイスでPCからはシリアルインターフェースとして使うことができます。GPS側はNMEA 0183フォーマットでデータが出力されており、ubloxのツールu-centerを使うことで動作状況のモニタと各種設定を行うことができます。一方PIC側は、時刻と内部でカウントした値を独自に書き出しています。いずれもPCからはテキストで読み出すことができます。</p>

<p>GPSモジュールのIOは3.3VなのでPICもそれに合わせています。シリアルとPPS信号のTIMEPULSEをPICに接続しています。また、OCXOからは正弦波が出力されていますので、バッファを通してPICに入力します。OCXOには周波数制御端子があり、試してみたところ10Hzほどの調整幅があるようです。5Vの小型のタイプを使用しましたので、電源はUSBでOKです。</p>

<p>さて、実際に動作させるとこんな感じです。屋外に設置したパッチアンテナをアンテナ端子に接続、そして電源兼用でUSBをPCに接続します。しばらくすると測位が行われてLCDにステータスが表示されます。LCDにはアイコンがいくつか用意されているので、GPSの受信状況(測位の有無、DGPSと3D測位)やUSBの接続状態などを表示させています。その他時刻と受信衛星数、HDOPは水平方向の位置精度(m)、そしてOCXOの周波数が10MHzからのずれ(Hz)を表示しています。制御電圧は0V固定で調整していないフリーランの状態で、周波数下限の状態では10MHzから4Hz弱下回っているようです。</p>

<p><img src="https://41.media.tumblr.com/f520419d69c61f9d0ac01b01c66c91d1/tumblr_inline_nuzu37RlMW1r9hszk_540.png" alt="image" /></p>

<p>PIC側のUSBをCDC接続するとこんな出力が得られます。</p>

<pre><code class="language-bash">20141011T075609 9999996  
20141011T075625 9999995  
20141011T075626 9999997  
20141011T075627 9999996  
20141011T075628 9999996  
20141011T075629 9999996  
20141011T075630 9999997  
20141011T075631 9999996  
</code></pre>

<p>毎秒1行出力され、最初がUTC時刻、後ろがOCXOのカウント値です。カウントはデッドタイム無しに全てをカウントしています。数値はタイミングによって1カウント前後しているのがわかります。</p>

<p>これをファイルに落としてグラフ化します。ファイルに落とすのはCDCのデバイスノードをcatで開いてリダイレクト、もしくはteeコマンドが使えます(OSX／Linuxの場合)。</p>

<pre><code class="language-bash">$ cat /dev/cu.usbmodem26431 | tee gps-ocxo.log 
</code></pre>

<p>動作が安定してからデータを取ります。ある程度の期間観測することが必要ですから、一日から一週間程度取ってみました。</p>

<p>このデータを例によってIPython notebookでグラフ化してみます。IPython notebookを開き、matplotlibとnumpyを使うための準備として下記をセルに入力しておきます。</p>

<pre><code class="language-bash">%matplotlib inline  
import pylab as pl  
import numpy as np
</code></pre>

<p>ファイルからデータを読み込み、2カラム目だけを取り出しておきます。</p>

<pre><code class="language-bash">data = np.loadtxt('gps-oxco.log', dtype={'names':('time','count'), 'formats':('S15', 'i')})  
d = data\['count'\]
</code></pre>

<p>まずはそのままプロットしてみます。</p>

<pre><code class="language-bash">pl.plot(d)
</code></pre>

<p><img src="https://41.media.tumblr.com/ca08deaefc31cd185fe3a6be6589c041/tumblr_inline_nuzwkzylPE1r9hszk_540.png" alt="image" /></p>

<p>縦軸の表示がちょっとヘンですが、数値はカウント値で9999995~9999998の整数値です。真の値はこの間のどこかにありますが、整数値に振り分けられているわけです。横軸の単位は秒で86400秒＝一日分です。</p>

<p>これではなんだかわかりませんので、移動平均を取ってみます。区間は600秒=10分です。</p>

<pre><code class="language-bash">def movingaverage(values, window):
   weights = np.repeat(1.0/window, window)
   return np.convolve(values, weights, 'valid')
  
v1 = movingaverage(d, 600)
pl.plot(v1)
</code></pre>

<p><img src="https://40.media.tumblr.com/254fe38ea32e61e74c30e3940b98b1e1/tumblr_inline_nuzwvdMY3u1r9hszk_540.png" alt="image" /></p>

<p>トレンドが見えるようになりましたが、これでもまだステップ状なので、さらにもう一度移動平均を重ねて掛けてみます。同じく区間は600秒です。</p>

<pre><code class="language-bash">v2 = movingaverage(v1, 600)
pl.plot(v2)
</code></pre>

<p><img src="https://41.media.tumblr.com/4491ecc9a4ae736bd2003af7ce5197f0/tumblr_inline_nuzwzerZua1r9hszk_540.png" alt="image" /></p>

<p>だいぶ滑らかになりました。大きく揺れ動いているように見えますが、縦軸1目盛りは0.001Hz=1mHzですから、全体ではおよそ10mHz弱の変動があることがわかります。10MHzに対する10mHzですから10^-9すなわち1ppb(part per billion:10億分の1)のオーダーです。フリーランのOCXOとGPSのゆれを合わせた安定度がこの程度ということです。ということで安定度のオーダーはわかりました。</p>

<p>移動平均を掛けるとは、すなわちLPFを通したことになります。移動平均の期間が600秒ですからノッチが1/600Hzに来ます。カットオフ周波数はそれよりも下に来ることになります。例のインターフェース特集記事でも少し詳しく解説しましたが、移動平均はCICと同値の処理でその周波数応答はSINC特性です。移動平均を2重にかけたので2段のCICと同じになるわけです。一応念のためですが、ノッチの位置は変化せず、減衰量が倍になるわけです。</p>

<p>変動のグラフは取れましたが、これを解析してみたいのです。具体的には時刻源の評価によく使われているアラン分散として示してみたいのです。</p>

<p>少し探してみると、ちゃんとアラン分散を計算するためのAllanToolsというライブラリがPythonにありました。AllanToolsは下記のようにコマンドラインからpipでインストールできます。</p>

<pre><code class="language-bash">$ sudo pip install AllanTools
</code></pre>

<p>インストール後、さきほど読み込んだデータで計算させてみるために、IPython notebookのセルに下記のように入力します。1Hzと10MHzの比較なので10MHzで除しています。</p>

<pre><code class="language-bash">import allantools
\# tau values from 1 to 10^5
t = np.logspace(0, 5, 50)
f=1e7
(t2, ad, ade, adn) = allantools.mdev(d/f, 1, t)
pl.loglog(t2, ad, '.-')
</code></pre>

<p>それっぽいグラフが得られます。このグラフは修正アラン分散(Modified Allan Deviation)です。他にもいくつか種類があり、それぞれ特徴があるようです。</p>

<p><img src="https://41.media.tumblr.com/314017234e41219896c1c7b159ad35e8/tumblr_inline_nv0cf9sejf1r9hszk_540.png" alt="image" /></p>

<p>1秒ごとに1カウントの誤差があるので、左側τ=10^0=1sに向けて数値が大きくなっています。また長期的にも揺れがあるためか、右側も上昇しています。グラフの傾きから安定性を損なう原因を推測できるのだそうです。果たしてこれが正しい結果なのか謎ですが、これを理解するために、もう少し研究してみたいと思います。</p>

<p>引き続き、DACを駆動して実際に周波数を合わせる調律動作をさせてみたいと考えています。</p>

<p>実は反省点があり、MCUにPIC18F14K50を使ったのは大失敗でした。というのもNMEAの読み込みと解析はテキスト処理が必要なのですが、このサイズのPICではRAMが全く足りません。全部で768バイトしかなく、USBのためのバッファを確保してしまうと、ごく僅かしか残りません。PICの癖である256バイト境界の制限(バッファが跨げない)もあり、現状でもとても苦しい状況です。周波数調整のための実装はできたとしても見通しが悪くなってしまいそうです。PICのコンパイラも使いにくいですし、ここは能力に余裕のあるCortex-M0くらいを奢っておくべきでした。</p>

<p>というわけで、次回に続きます。</p>

<p>リファレンス</p>

<ul>
<li><a href="../2014-10-22-ublox-lea-6t-gps-breakout-board">前回の記事(1年前)</a></li>
<li>ublox LEA-6 Data Sheet <a href="https://www2.u-blox.com/images/downloads/Product_Docs/LEA-6_DataSheet_%28GPS.G6-HW-09004%29.pdf" target="_blank">https://www2.u-blox.com/images/downloads/Product_Docs/LEA-6_DataSheet_%28GPS.G6-HW-09004%29.pdf</a></li>

<li><p>ublox Hardware Integration Manual : モジュールを使うための回路設計についてのガイド <a href="https://www2.u-blox.com/images/downloads/Product_Docs/LEA-6_NEO-6_MAX-6_HardwareIntegrationManual_%28GPS.G6-HW-09007%29.pdf" target="_blank">https://www2.u-blox.com/images/downloads/Product_Docs/LEA-6_NEO-6_MAX-6_HardwareIntegrationManual_%28GPS.G6-HW-09007%29.pdf</a></p></li>

<li><p>u-blox 6 Receiver Description : NMEA 0183やublox独自を含むプロトコル仕様はこちら <a href="https://www2.u-blox.com/images/downloads/Product_Docs/u-blox6_ReceiverDescriptionProtocolSpec_%28GPS.G6-SW-10018%29.pdf" target="_blank">https://www2.u-blox.com/images/downloads/Product_Docs/u-blox6_ReceiverDescriptionProtocolSpec_%28GPS.G6-SW-10018%29.pdf</a></p></li>

<li><p>GPS-based Timing : ubloxのアプリケーションノート。9pにTIMEPULSEのジッタに言及。11pに波形の例。 <a href="https://www2.u-blox.com/images/downloads/Product_Docs/Timing_AppNote_%28GPS.G6-X-11007%29.pdf" target="_blank">https://www2.u-blox.com/images/downloads/Product_Docs/Timing_AppNote_%28GPS.G6-X-11007%29.pdf</a></p></li>

<li><p>いつもとても参考になるAgilentのApplication Note。AN1289 The Science of Timekeeping <a href="http://literature.agilent.com/litweb/pdf/5965-7984E.pdf" target="_blank">http://literature.agilent.com/litweb/pdf/5965-7984E.pdf</a></p></li>

<li><p>日本の時刻を司るNICTの解説資料。日本語で読めるのは有り難いです。<a href="http://www.nict.go.jp/publication/shuppan/kihou-journal/kihou-vol56no3_4/kihou-vol56no3_4_0201.pdf" target="_blank">http://www.nict.go.jp/publication/shuppan/kihou-journal/kihou-vol56no3_4/kihou-vol56no3_4_0201.pdf</a> <a href="http://www.nict.go.jp/publication/shuppan/kihou-journal/kihou-vol49no1.2/02-02.pdf" target="_blank">http://www.nict.go.jp/publication/shuppan/kihou-journal/kihou-vol49no1.2/02-02.pdf</a></p></li>

<li><p>邦書の教科書(残念ながら絶版、改訂再版を望みます)。「周波数と時間」電子情報通信学会 (1995/08) ISBN:4885520851</p></li>

<li><p>AllanTools <a href="https://github.com/aewallin/allantools" target="_blank">https://github.com/aewallin/allantools</a></p></li>

<li><p>ojisankoubouでルビジウムを基準にGPSやOCXOの安定度を評価されています <a href="http://ojisankoubou.web.fc2.com/lpro-101/index.html" target="_blank">http://ojisankoubou.web.fc2.com/lpro-101/index.html</a></p></li>
</ul>
        </div>
        

<footer class="post-footer">
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn">TT</span></span>
    
    at <time>Sep 21, 2015</time>
	<a href="https://ttrf.tk/posts/2015-09-21-gps-based-ocxo-stability-measurement/" class="permalink">Permalink ∞</a>
    
      <span class="categories">
        Tags:
        
          <a class="category" href="https://ttrf.tk/tags/gps">gps</a>  <a class="category" href="https://ttrf.tk/tags/ocxo">ocxo</a>  
    
    </span>
  </p>

<iframe src="https://www.facebook.com/plugins/like.php?href=https%3a%2f%2fttrf.tk%2fposts%2f2015-09-21-gps-based-ocxo-stability-measurement%2f&amp;send=false&amp;layout=button_count&amp;width=75&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=20&amp;locale=en_US" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:75px; height:20px;"></iframe>
<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://ttrf.tk/posts/2015-09-21-gps-based-ocxo-stability-measurement/" data-text="GPSのPPS信号を基準にOCXOの安定度を観察してみる" data-via="edy555">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
<a href="https://b.hatena.ne.jp/entry/https://ttrf.tk/posts/2015-09-21-gps-based-ocxo-stability-measurement/" class="hatena-bookmark-button" data-hatena-bookmark-title="Computer RF Tech" data-hatena-bookmark-layout="simple-balloon" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only.gif" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>

</footer>

		
		
		<div id="disqus_thread"></div>
<script type="text/javascript">
  (function() {
      
      
      
      if (window.location.hostname == "localhost")
          return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'ttrftech';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

		
		
      </article>
    </div>
  </div>
</div>

	</div>
        <div id="footer">
      <p>Copyright &copy; 2019 TT - <a href="https://ttrf.tk/license/">License</a> -
        <span class="credit">Powered by <a target="_blank" href="https://gohugo.io">Hugo</a>.
      </p>
    </div>

    
      <script>
        var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
        (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
        s.parentNode.insertBefore(g,s)}(document,'script'));
      </script>
    
  </body>
</html>

  </body>
</html>
